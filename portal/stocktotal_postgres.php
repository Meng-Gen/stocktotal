<?php    class StocktotalPostgres {            public function __construct() {            $this->conn = pg_connect($this->conn_str) or die("Could not connect to server: " . pg_last_error());            }        public function __destruct() {            pg_close($this->conn);         }        public function query_roe($stock_code) {            $sql_cmd = "select * from roe('$stock_code') order by activity_date";             $query = pg_query($this->conn, $sql_cmd) or die("Could not execute query: $sql_cmd");            $rv = array();            while ($row = pg_fetch_row($query)) {                $record = array(                    'date' => $row[0],                     'roe' => round($row[1], 4),                     'net_profit_margin' => round($row[2], 4),                     'total_assets_turnover' => round($row[3], 4),                     'equity_multiplier' => round($row[4], 2)                );                $rv[] = $record;            }            pg_free_result($query);            return $rv;        }                public function query_financial_structure($stock_code) {            $sql_cmd = "select * from financial_structure('$stock_code') order by activity_date";             $query = pg_query($this->conn, $sql_cmd) or die("Could not execute query: $sql_cmd");            $rv = array();            while ($row = pg_fetch_row($query)) {                $record = array(                    'date' => $row[0],                     'equity_ratio' => round($row[1], 4),                     'liabilities_ratio' => round($row[2], 4),                     'equity_multiplier' => round($row[3], 2)                );                $rv[] = $record;            }            pg_free_result($query);            return $rv;        }                private $conn_str = "host=127.0.0.1 port=5432 dbname=stocktotal user=stocktotal password=stocktotal";        private $conn;    }?>